generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters", "multiSchema"]
}

datasource db {
  provider = "postgresql"
  schemas  = ["tutor"]
}

model StudentState {
  id               String    @id @default(uuid())
  studentDid       String    @unique @map("student_did")
  currentQuest     String?   @map("current_quest")
  helpClickCount   Int       @default(0) @map("help_click_count")
  lastHelpAt       DateTime? @map("last_help_at")
  mode             String    @default("ASSISTANT") // ASSISTANT, TEACHER, SOCRATIC
  gritScore        Float     @default(1.0) @map("grit_score")
  traits           Json?
  createdAt        DateTime  @default(now()) @map("created_at")
  updatedAt        DateTime  @updatedAt @map("updated_at")

  @@schema("tutor")
  @@map("student_state")
}

model Trait {
  id          String   @id @default(uuid())
  studentDid  String   @map("student_did")
  name        String
  value       Float    @default(0.0)
  evidence    String?
  updatedAt   DateTime @updatedAt @map("updated_at")

  @@unique([studentDid, name])
  @@schema("tutor")
  @@map("trait")
}
